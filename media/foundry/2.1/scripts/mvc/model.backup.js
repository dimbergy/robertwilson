!function(){var moduleFactory=function($){var module=this;$.require().script("mvc/model").done(function(){var exports=function(){var isArray=$.isArray,propCount=function(obj){var count=0;for(var prop in obj)count++;return count},same=function(a,b,deep){var aType=typeof a,aArray=isArray(a);if(deep===-1){return aType==="object"||a===b}if(aType!==typeof b||aArray!==isArray(b)){return false}if(a===b){return true}if(aArray){if(a.length!==b.length){return false}for(var i=0;i<a.length;i++){if(!same(a[i],b[i])){return false}}return true}else if(aType==="object"||aType==="function"){var count=0;for(var prop in a){if(!same(a[prop],b[prop],deep===false?-1:undefined)){return false}count++}return count===propCount(b)}return false},flatProps=function(a){var obj={};for(var prop in a){if(typeof a[prop]!=="object"||a[prop]===null){obj[prop]=a[prop]}}return obj};$.extend($.Model.prototype,{backup:function(){this._backupStore=this.serialize();return this},isDirty:function(checkAssociations){if(!this._backupStore){return false}else{return!same(this.serialize(),this._backupStore,!!checkAssociations)}},restore:function(restoreAssociations){var props=restoreAssociations?this._backupStore:flatProps(this._backupStore);this.attrs(props);return this}})};exports();module.resolveWith(exports)})};dispatch("mvc/model.backup").containing(moduleFactory).to("Foundry/2.1 Modules")}();