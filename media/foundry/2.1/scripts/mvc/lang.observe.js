!function(){var moduleFactory=function($){var module=this;$.require().script("mvc/class").done(function(){var exports=function(){var isArray=$.isArray,isObject=function(obj){return typeof obj==="object"&&obj!==null&&obj},makeArray=$.makeArray,each=$.each,hookup=function(val,prop,parent){if(val instanceof $.Observe){unhookup([val],parent._namespace)}else if(isArray(val)){val=new $.Observe.List(val)}else{val=new $.Observe(val)}val.bind("change"+parent._namespace,function(ev,attr){var args=$.makeArray(arguments),ev=args.shift();if(prop==="*"){args[0]=parent.indexOf(val)+"."+args[0]}else{args[0]=prop+"."+args[0]}$.event.trigger(ev,args,parent)});return val},unhookup=function(items,namespace){var item;for(var i=0;i<items.length;i++){item=items[i];if(item&&item.unbind){item.unbind("change"+namespace)}}},id=0,collecting=null,collect=function(){if(!collecting){collecting=[];return true}},trigger=function(item,event,args){if(item._init){return}if(!collecting){return $.event.trigger(event,args,item,true)}else{collecting.push({t:item,ev:event,args:args})}},batchNum=0,sendCollection=function(){var len=collecting.length,items=collecting.slice(0),cur;collecting=null;batchNum++;for(var i=0;i<len;i++){cur=items[i];$.event.trigger({type:cur.ev,batchNum:batchNum},cur.args,cur.t)}},serialize=function(observe,how,where){observe.each(function(name,val){where[name]=isObject(val)&&typeof val[how]=="function"?val[how]():val});return where};$.Class($.globalNamespace+".Observe",{init:function(obj){this._data={};this._namespace=".observe"+ ++id;this._init=true;this.attrs(obj);delete this._init},attr:function(attr,val){if(val===undefined){return this._get(attr)}else{this._set(attr,val);return this}},each:function(){return each.apply(null,[this.__get()].concat(makeArray(arguments)))},removeAttr:function(attr){var parts=isArray(attr)?attr:attr.split("."),prop=parts.shift(),current=this._data[prop];if(parts.length){return current.removeAttr(parts)}else{delete this._data[prop];trigger(this,"change",[prop,"remove",undefined,current]);return current}},_get:function(attr){var parts=isArray(attr)?attr:(""+attr).split("."),current=this.__get(parts.shift());if(parts.length){return current?current._get(parts):undefined}else{return current}},__get:function(attr){return attr?this._data[attr]:this._data},_set:function(attr,value){var parts=isArray(attr)?attr:(""+attr).split("."),prop=parts.shift(),current=this.__get(prop);if(isObject(current)&&parts.length){current._set(parts,value)}else if(!parts.length){if(value!==current){var changeType=this.__get().hasOwnProperty(prop)?"set":"add";this.__set(prop,isObject(value)?hookup(value,prop,this):value);trigger(this,"change",[prop,changeType,value,current]);current&&unhookup([current],this._namespace)}}else{throw"jQuery.Observe: set a property on an object that does not exist"}},__set:function(prop,val){this._data[prop]=val;if(!(prop in this.constructor.prototype)){this[prop]=val}},bind:function(eventType,handler){$.fn.bind.apply($([this]),arguments);return this},unbind:function(eventType,handler){$.fn.unbind.apply($([this]),arguments);return this},serialize:function(){return serialize(this,"serialize",{})},attrs:function(props,remove){if(props===undefined){return serialize(this,"attrs",{})}props=$.extend(true,{},props);var prop,collectingStarted=collect();for(prop in this._data){var curVal=this._data[prop],newVal=props[prop];if(newVal===undefined){remove&&this.removeAttr(prop);continue}if(isObject(curVal)&&isObject(newVal)){curVal.attrs(newVal,remove)}else if(curVal!=newVal){this._set(prop,newVal)}else{}delete props[prop]}for(var prop in props){newVal=props[prop];this._set(prop,newVal)}if(collectingStarted){sendCollection()}}});var list=$.Observe($.globalNamespace+".Observe.List",{init:function(instances,options){this.length=0;this._namespace=".list"+ ++id;this._init=true;this.bind("change",this.proxy("_changes"));this.push.apply(this,makeArray(instances||[]));$.extend(this,options);if(this.comparator){this.sort()}delete this._init},_changes:function(ev,attr,how,newVal,oldVal){if(this.comparator&&/^\d+./.test(attr)){var index=+/^\d+/.exec(attr)[0],item=this[index],newIndex=this.sortedIndex(item);if(newIndex!==index){[].splice.call(this,index,1);[].splice.call(this,newIndex,0,item);trigger(this,"move",[item,newIndex,index]);ev.stopImmediatePropagation();trigger(this,"change",[attr.replace(/^\d+/,newIndex),how,newVal,oldVal]);return}}if(attr.indexOf(".")===-1){if(how==="add"){trigger(this,how,[newVal,+attr])}else if(how==="remove"){trigger(this,how,[oldVal,+attr])}}},sortedIndex:function(item){var itemCompare=item.attr(this.comparator),equaled=0,i;for(var i=0;i<this.length;i++){if(item===this[i]){equaled=-1;continue}if(itemCompare<=this[i].attr(this.comparator)){return i+equaled}}return i+equaled},__get:function(attr){return attr?this[attr]:this},__set:function(attr,val){this[attr]=val},serialize:function(){return serialize(this,"serialize",[])},splice:function(index,count){var args=makeArray(arguments),i;for(i=2;i<args.length;i++){var val=args[i];if(isObject(val)){args[i]=hookup(val,"*",this)}}if(count===undefined){count=args[1]=this.length-index}var removed=[].splice.apply(this,args);if(count>0){trigger(this,"change",[""+index,"remove",undefined,removed]);unhookup(removed,this._namespace)}if(args.length>2){trigger(this,"change",[""+index,"add",args.slice(2),removed])}return removed},attrs:function(props,remove){if(props===undefined){return serialize(this,"attrs",[])}props=props.slice(0);var len=Math.min(props.length,this.length),collectingStarted=collect();for(var prop=0;prop<len;prop++){var curVal=this[prop],newVal=props[prop];if(isObject(curVal)&&isObject(newVal)){curVal.attrs(newVal,remove)}else if(curVal!=newVal){this._set(prop,newVal)}else{}}if(props.length>this.length){this.push(props.slice(this.length))}else if(props.length<this.length&&remove){this.splice(props.length)}if(collectingStarted){sendCollection()}},sort:function(method,silent){var comparator=this.comparator,args=comparator?[function(a,b){a=a[comparator];b=b[comparator];return a===b?0:a<b?-1:1}]:[],res=[].sort.apply(this,args);!silent&&trigger(this,"reset")}}),getArgs=function(args){if(args[0]&&$.isArray(args[0])){return args[0]}else{return makeArray(args)}};each({push:"length",unshift:0},function(name,where){list.prototype[name]=function(){var args=getArgs(arguments),len=where?this.length:0;for(var i=0;i<args.length;i++){var val=args[i];if(isObject(val)){args[i]=hookup(val,"*",this)}}if(args.length==1&&this.comparator){var index=this.sortedIndex(args[0]);this.splice(index,0,args[0]);return this.length}var res=[][name].apply(this,args);if(this.comparator&&args.length>1){this.sort(null,true);trigger(this,"reset",[args])}else{trigger(this,"change",[""+len,"add",args,undefined])}return res}});each({pop:"length",shift:0},function(name,where){list.prototype[name]=function(){var args=getArgs(arguments),len=where&&this.length?this.length-1:0;var res=[][name].apply(this,args);trigger(this,"change",[""+len,"remove",undefined,[res]]);if(res&&res.unbind){res.unbind("change"+this._namespace)}return res}});list.prototype.indexOf=[].indexOf||function(item){return $.inArray(item,this)};$.O=function(data,options){if(isArray(data)||data instanceof $.Observe.List){return new $.Observe.List(data,options)}else{return new $.Observe(data,options)}}};exports();module.resolveWith(exports)})};dispatch("mvc/lang.observe").containing(moduleFactory).to("Foundry/2.1 Modules")}();