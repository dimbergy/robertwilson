(function(){(function(a){if(typeof define==="function"&&define.amd){return define(["jquery"],a);}else{return a(window.jQuery);}})(function(f){var j,l,a,i,c,e,g,k,b,h,d;h="caret";j=(function(){function m(n){this.$inputor=n;this.domInputor=this.$inputor[0];}m.prototype.setPos=function(n){return this.domInputor;};m.prototype.getIEPosition=function(){return f.noop();};m.prototype.getPosition=function(){return f.noop();};m.prototype.getOldIEPos=function(){var o,n;n=g.selection.createRange();o=g.body.createTextRange();o.moveToElementText(this.domInputor);o.setEndPoint("EndToEnd",n);return o.text.length;};m.prototype.getPos=function(){var n,p,o;if(o=this.range()){n=o.cloneRange();n.selectNodeContents(this.domInputor);n.setEnd(o.endContainer,o.endOffset);p=n.toString().length;n.detach();return p;}else{if(g.selection){return this.getOldIEPos();}}};m.prototype.getOldIEOffset=function(){var n,o;n=g.selection.createRange().duplicate();n.moveStart("character",-1);o=n.getBoundingClientRect();return{height:o.bottom-o.top,left:o.left,top:o.top};};m.prototype.getOffset=function(r){var n,q,o,p;if(b.getSelection&&(o=this.range())){if(o.endOffset-1<0){return null;}n=o.cloneRange();n.setStart(o.endContainer,o.endOffset-1);n.setEnd(o.endContainer,o.endOffset);p=n.getBoundingClientRect();q={height:p.height,left:p.left+p.width,top:p.top};n.detach();}else{if(g.selection){q=this.getOldIEOffset();}}if(q&&!k){q.top+=f(b).scrollTop();q.left+=f(b).scrollLeft();}return q;};m.prototype.range=function(){var n;if(!b.getSelection){return;}n=b.getSelection();if(n.rangeCount>0){return n.getRangeAt(0);}else{return null;}};return m;})();l=(function(){function m(n){this.$inputor=n;this.domInputor=this.$inputor[0];}m.prototype.getIEPos=function(){var q,s,o,r,t,p,n;s=this.domInputor;p=g.selection.createRange();t=0;if(p&&p.parentElement()===s){r=s.value.replace(/\r\n/g,"\n");o=r.length;n=s.createTextRange();n.moveToBookmark(p.getBookmark());q=s.createTextRange();q.collapse(false);if(n.compareEndPoints("StartToEnd",q)>-1){t=o;}else{t=-n.moveStart("character",-o);}}return t;};m.prototype.getPos=function(){if(g.selection){return this.getIEPos();}else{return this.domInputor.selectionStart;}};m.prototype.setPos=function(p){var o,n;o=this.domInputor;if(g.selection){n=o.createTextRange();n.move("character",p);n.select();}else{if(o.setSelectionRange){o.setSelectionRange(p,p);}}return o;};m.prototype.getIEOffset=function(r){var o,p,n,q;p=this.domInputor.createTextRange();r||(r=this.getPos());p.move("character",r);n=p.boundingLeft;q=p.boundingTop;o=p.boundingHeight;return{left:n,top:q,height:o};};m.prototype.getOffset=function(q){var o,p,n;o=this.$inputor;if(g.selection){p=this.getIEOffset(q);p.top+=f(b).scrollTop()+o.scrollTop();p.left+=f(b).scrollLeft()+o.scrollLeft();return p;}else{p=o.offset();n=this.getPosition(q);return p={left:p.left+n.left-o.scrollLeft(),top:p.top+n.top-o.scrollTop(),height:n.height};}};m.prototype.getPosition=function(t){var r,s,q,o,p,n;r=this.$inputor;q=function(u){return u.replace(/</g,"&lt").replace(/>/g,"&gt").replace(/`/g,"&#96").replace(/"/g,"&quot").replace(/\r\n|\r|\n/g,"<br />");};if(t===void 0){t=this.getPos();}n=r.val().slice(0,t);o="<span>"+q(n)+"</span>";o+="<span id='caret'>|</span>";p=new a(r);return s=p.create(o).rect();};m.prototype.getIEPosition=function(s){var o,r,p,n,q;p=this.getIEOffset(s);r=this.$inputor.offset();n=p.left-r.left;q=p.top-r.top;o=p.height;return{left:n,top:q,height:o};};return m;})();a=(function(){m.prototype.css_attr=["overflowY","height","width","paddingTop","paddingLeft","paddingRight","paddingBottom","marginTop","marginLeft","marginRight","marginBottom","fontFamily","borderStyle","borderWidth","wordWrap","fontSize","lineHeight","overflowX","text-align"];function m(n){this.$inputor=n;}m.prototype.mirrorCss=function(){var n,o=this;n={position:"absolute",left:-9999,top:0,zIndex:-20000,"white-space":"pre-wrap"};f.each(this.css_attr,function(q,r){return n[r]=o.$inputor.css(r);});return n;};m.prototype.create=function(n){this.$mirror=f("<div></div>");this.$mirror.css(this.mirrorCss());this.$mirror.html(n);this.$inputor.after(this.$mirror);return this;};m.prototype.rect=function(){var o,p,n;o=this.$mirror.find("#caret");p=o.position();n={left:p.left,top:p.top,height:o.height()};this.$mirror.remove();return n;};return m;})();i={contentEditable:function(m){return !!(m[0].contentEditable&&m[0].contentEditable==="true");}};e={pos:function(m){if(m||m===0){return this.setPos(m);}else{return this.getPos();}},position:function(m){if(g.selection){return this.getIEPosition(m);}else{return this.getPosition(m);}},offset:function(o){var m,n;n=this.getOffset(o);if(k){m=f(k).offset();n.top+=m.top;n.left+=m.left;}return n;}};g=null;b=null;k=null;d=function(m){k=m;b=m.contentWindow;return g=m.contentDocument||b.document;};c=function(m,p){var n,o;if(f.isPlainObject(p)&&(o=p.iframe)){m.data("caret-iframe",o);return d(o);}else{if(o=m.data("caret-iframe")){return d(o);}else{g=m[0].ownerDocument;b=g.defaultView||g.parentWindow;try{return k=b.frameElement;}catch(q){n=q;}}}};f.fn.caret=function(n){var m;if(typeof n==="object"){c(this,n);return this;}else{if(e[n]){c(this);m=i.contentEditable(this)?new j(this):new l(this);return e[n].apply(m,Array.prototype.slice.call(arguments,1));}else{return f.error("Method "+n+" does not exist on jQuery.caret");}}};f.fn.caret.EditableCaret=j;f.fn.caret.InputCaret=l;f.fn.caret.Utils=i;return f.fn.caret.apis=e;});}).call(this);